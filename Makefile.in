
srcdir = @srcdir@/src

config = ./src/include/config.h

LDFLAGS = @LDFLAGS@
CXXFLAGS = @CXXFLAGS@ -I./src/include
CXX = @CXX@ $(CXXFLAGS)
CC = @CC@ $(CFLAGS)
AR = @AR@
RANLIB = @RANLIB@
INSTALL = @INSTALL@
MKDIR = @MKDIR@
LIBS = @LIBS@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = @bindir@
libdir = @libdir@
includedir = @includedir@

PREFIX = $(DESTDIR)$(prefix)
EPREFIX = $(DESTDIR)$(exec_prefix)
BINDIR = $(DESTDIR)$(bindir)
INCLUDEDIR = $(DESTDIR)$(includedir)
LIBDIR = $(DESTDIR)$(libdir)

INSTALL_BIN = $(INSTALL) -m755
INSTALL_INC = $(INSTALL) -m644
INSTALL_LIB = $(INSTALL) -m644

BUILD = @build@
HOST = @host@
HOST_OS = @host_os@

.PHONY: all install
maward: $(srcdir)/main.cpp xmppserver.o xmppstream.o myconsole.o xml_tag.o tagbuilder.o
	$(CXX) $(srcdir)/main.cpp xmppserver.o xmppstream.o myconsole.o xml_tag.o tagbuilder.o $(LDFLAGS) $(LIBS) -o maward

# modules

xmppserver.o: $(srcdir)/xmppserver.cpp $(srcdir)/include/xmppserver.h
	$(CXX) -c $(srcdir)/xmppserver.cpp -o xmppserver.o

xmppstream.o: $(srcdir)/xmppstream.cpp $(srcdir)/include/xmppstream.h $(srcdir)/include/tagbuilder.h
	$(CXX) -c $(srcdir)/xmppstream.cpp -o xmppstream.o

myconsole.o: $(srcdir)/myconsole.cpp $(srcdir)/include/myconsole.h
	$(CXX) -c $(srcdir)/myconsole.cpp -o myconsole.o

xml_tag.o: $(srcdir)/xml_tag.cpp $(srcdir)/include/xml_tag.h $(srcdir)/include/xml_types.h
	$(CXX) -c $(srcdir)/xml_tag.cpp -o xml_tag.o

tagbuilder.o: $(srcdir)/tagbuilder.cpp $(srcdir)/include/tagbuilder.h $(srcdir)/include/xml_types.h
	$(CXX) -c $(srcdir)/tagbuilder.cpp -o tagbuilder.o

# CLEAN

.PHONY: clean distclean

distclean: clean
	rm -f Makefile *.log  $(config) config.status

clean:
	rm -f *.o maward
